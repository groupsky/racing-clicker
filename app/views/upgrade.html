<div class="upgrade upgrade-{{::upgrade.name}}"
  tooltip="{{::upgrade.type.description}}"
  tooltip-trigger="mouseenter click"
  tooltip-placement="bottom"
  tooltip-append-to-body="true">
  <div ng-if="upgrade.isCostMet()">
    <button class="btn btn-upgrade"
            title="{{::upgrade.type.label}}"
            ng-class="{'btn-primary': upgrade.isCostMet(), 'btn-default': !upgrade.isCostMet()}"
            ng-click="commands.buyUpgrade({upgrade: upgrade})" action-effect>
      {{::upgrade.type.short}}
    </button>
  </div>
  <div ng-if="!upgrade.isCostMet()">
    <div class="progress" style="margin-bottom:0">
      <div class="progress-bar" role="progressbar" aria-valuenow="{{upgrade.costMetPercent().times(1000)}}"
           aria-valuemin="0" aria-valuemax="1000" ng-style="{width:upgrade.costMetPercent().times(100)+'%'}">
        {{upgrade.costMetPercent()|percent:{floor:true} }} {{upgrade|estimate|duration}}
      </div>
    </div>
    <div style="clear:right"></div>
  </div>
  <div class="costs">
    <unit-resource ng-repeat="cost in upgrade.totalCost() track by cost.unit.name"
                   value="cost.val"
                   unit="::cost.unit"
                   ng-class="{positive: isCostMet(cost), negative: !isCostMet(cost)}"></unit-resource>
  </div>
</div>
